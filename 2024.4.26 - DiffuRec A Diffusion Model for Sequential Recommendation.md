# 2024.4.26 - DiffuRec: A Diffusion Model for Sequential Recommendation

## 1.摘要

流行的序列推荐解决方案通常用固定向量表示物品。这些向量在捕捉物品的潜在方面和用户的多样化偏好方面能力有限。作为一种新的生成范式，扩散模型在计算机视觉和自然语言处理等领域取得了优异的表现。根据我们的理解，其在表示生成方面的独特优势非常适合序列推荐的问题设定。在本文中，**我们首次尝试将扩散模型适配到序列推荐中，**并提出了**DiffuRec来构建物品表示和注入不确定性**。DiffuRec不是将物品表示模型化为固定向量，而是将其表示为分布，这些分布能够适应性地反映用户的多重兴趣和物品的各种方面。在扩散阶段，DiffuRec通过添加噪声将目标物品嵌入转化为高斯分布，进而用于序列物品分布表示的生成和不确定性注入。之后，将物品表示输入到一个近似器中，以重构目标物品表示。在逆向阶段，基于用户的历史互动行为，我们将高斯噪声逆转回目标物品表示，然后执行舍入操作以预测目标物品。在四个数据集上的实验表明，DiffuRec的表现大大超过了强基准。

## 2 .Introduction

介绍了 Sequential recommendation  的基础含义

介绍了现有的方法 ， 例如 使用了 RNN ， LSTM的循环神经网络 ， Attention  ， GNN ， 等

所有这些主流方法都将**项目表示学习为嵌入向量**。然而，我们认为固定向量在同时捕获以下四个特征方面的能力可能有限：

指出现有方法存在的问题：

1. **多个潜在方面：**在实际场景中，商品可能包含不同的潜在方面。我们将电影推荐场景作为运行示例（如图 1 所示）。项目的各个方面可以看作是电影的主题或类别。因此，不同的电影将包含不同的主题分布（向左圈）。例如，Titanic 是一个浪漫电影，而 Life Is Beautiful 包含 Love 和 War 的主题。请注意，在许多推荐场景中，很难用相应的方面明确定义和准确地注释项目。在单个向量中编码复杂的潜在方面仍然具有挑战性[9,10]。
2. **多重兴趣：**用户的兴趣和偏好多样且不稳定。此外，用户可以根据不同的场景或时期动态调整自己的兴趣。因此，她关注项目的各种潜在方面也可能漂移。如图 1 所示，当用户对主题（即 Love 和 War）的偏好发生变化时，项目的每个潜在方面的重要性也应该以用户感知的方式相应地调整。从这个角度来看，用户之间的静态项目表示也是不够的[10]。
3. **不确定性**：由于用户兴趣的多样性和演变，用户当前的偏好和意图在一定程度上变得不确定。然而，信息系统的多样性、新颖性、ACM交易，Vol。42, 不。3，第66条。发布日期：12月2023日。DiffuRec：来自推荐系统[9，24，58]也期望用于顺序推荐66：3Serendipity的扩散模型和通过推荐项目反映的不确定性。我们认为，将用户当前兴趣建模为分布更合适。
4. **目标项目的指导**：最后，目标项目可以促进用户当前的意图理解，它可以作为辅助信号来指导后一个过程[48]。然而，由于涉及目标项的交互可以为网络设计带来巨大的计算成本和深度耦合，推理速度也与候选池的大小高度相关。虽然已经提出了一些工作，但它们仅适用于排名阶段。

为了解决上述问题 ， 作者尝试了很多方法。但是存在表示能力有限、后延分布近似崩溃 ，以及不能在一个统一的框架下将用户的多个兴趣和项目的多个潜在方面建模为分布

指出Diffusion在CV和NLP中的success 。在本文中尝试拟合DIffusion与推荐的差距 ， 提出了 DIFFUREC

简单介绍一下DIFFUSION  ， 并指出做出的贡献：

- **据我们所知，**这是第一次尝试将扩散模型应用于顺序推荐。由于扩散模型的分布生成的固有能力，我们能够将项目的多潜在方面和用户的不同意图建模为分布。
- 我们设计了一个**扩散模型**，可以固有地融合目标项嵌入以进行历史交互项表示生成。因此，用户当前的偏好和意图可以作为辅助信号引入，以便更好地理解用户。此外，一些不确定性也可以注入到建模训练过程中，以增强模型的鲁棒性。
- 我们对四个真实世界的**数据集进行了实验**，以验证 DiffuRec 的有效性。结果表明，DiffuRec 大大优于九个现有的强基线。广泛的消融研究和实证分析也阐明了我们提出的组件的有效性。

## Related Work

简要介绍一些基础知识

- 序列推荐
- 多兴趣建模
- 表示分布和不稳定性建模
- 扩散模型

## preliminary  ~~准备工作~~





![image-20240426111426314](C:\Users\杜冠辰\AppData\Roaming\Typora\typora-user-images\image-20240426111426314.png)

## METHODOLOGY

首先，我们正式定义序列推荐的任务，然后介绍我们提出的DiffuRec模型的技术细节，包括用于模型训练和推理的扩散和逆向过程，用于序列建模和目标物品表示重构的近似器，用于目标物品索引投影的舍入操作，以及用于模型优化的损失函数。序列推荐：给定一组物品I，一组用户U和他们的互动记录，我们可以按时间顺序组织每个用户的互动为一个序列S =[iu1 , iu2 , . . . , iu n−1, iu n]。这里，u ∈ U，iu j ∈ I表示与用户u互动的第j个物品。n是序列长度，也是用户u的总互动次数。序列推荐的目标是生成一个排名列表，作为下一个用户u可能喜欢的物品的预测候选。正如其名称所示，DiffuRec是基于扩散模型构建的。DiffuRec的整体架构如图2所示，主要包括三个部分：（1）用于目标物品表示重构的近似器，（2）扩散（训练）过程，以整合目标物品的指导并注入噪声以增强近似器学习的鲁棒性，（3）用于目标物品预测的逆向（推理）阶段

### 1. overview

![image-20240426112222670](C:\Users\杜冠辰\AppData\Roaming\Typora\typora-user-images\image-20240426112222670.png)

### 2 .Approximator

![image-20240426112557848](C:\Users\杜冠辰\AppData\Roaming\Typora\typora-user-images\image-20240426112557848.png)

![image-20240426112931967](C:\Users\杜冠辰\AppData\Roaming\Typora\typora-user-images\image-20240426112931967.png)

![image-20240426113044373](C:\Users\杜冠辰\AppData\Roaming\Typora\typora-user-images\image-20240426113044373.png)

![image-20240426114133408](C:\Users\杜冠辰\AppData\Roaming\Typora\typora-user-images\image-20240426114133408.png)

### 上述都是没有用的

#### 该论文的损失函数 是这样构造的 

##### 首先 得到我们在DIFFUSION里面所生成的$\hat{x_0}$ ， 然后把我们下一个时刻的项目拿过来 $e_{n+1}$ , （ps： $e_{n}$表示当前商品 ， 而$e_{n+1}$表示的是下一个时刻的商品），使用 经典的类似于$softmax$的损耗函数得到 该时刻的推荐与下一时刻的推荐的关系概率$\hat{y}$ 这样，我们就可以使用

$$ loss = \frac{\sum_{i∈U}{-log_e{\hat{y}}}}{U}$$

最后序列的推荐由 $x_0 \times e_i$给出